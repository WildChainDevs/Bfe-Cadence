!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@onflow/config"),require("@onflow/types"),require("@onflow/fcl")):"function"==typeof define&&define.amd?define(["exports","@onflow/config","@onflow/types","@onflow/fcl"],t):t((e||self).flowCadut={},e.config,e.t,e.fcl)}(this,function(e,t,r,n){function o(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,t}var s=o(r),c=o(n);const a={emulator:{FlowToken:"0xee82856bf20e2aa6",FungibleToken:"0x0ae53cb6e3f42a79"},testnet:{FlowToken:"0x7e60df042a9c0868",FungibleToken:"0x9a0766d93b6608b7",LockedTokens:"0x95e019a17d0e23d7",StakingProxy:"0x7aad92e5a0715d21"},mainnet:{FlowToken:"0x1654653399040a61",FungibleToken:"0xf233dcee88fe0abe",LockedTokens:"0x8d0e87b65159ae63",StakingProxy:"0x62430cf28c26d095"}},i={mainnet:"https://access.mainnet.onflow.org",testnet:"https://access-testnet.onflow.org",emulator:"http://localhost:8080"},u=e=>e.split(/\s/).map(e=>e.replace(/\s/g,"")).filter(e=>e.length>0&&"import"!==e&&"from"!==e),l=(e,t)=>{const[r,n]=t;return e[r]=n,e},p=e=>e&&0!==e.length?e.split("\n").filter(e=>e.includes("import")).map(u).reduce(l,{}):{},f=(e,t={})=>{const r=p(e),n=[];for(const e in r)!t[e]&&Object.prototype.hasOwnProperty.call(r,e)&&n.push(e);return n},d=(e=[],t="")=>{const r="Missing imports for contracts:";console.error(t?`${t} ${r}`:r,e)},g=/(\s*import\s*)([\w\d]+)(\s+from\s*)([\w\d".\\/]+)/g,m=(e,t,r=!0)=>e.replace(g,(e,n,o,s,c)=>{const a=r?o:c;return`${n}${o} from ${(t instanceof Function?t(a):t[a])||c}`}),h=e=>{const[t]=e.split("");return t.toUpperCase()+e.slice(1)},x=e=>{switch(!0){case e.indexOf("//")>=0:return"//";case e.indexOf("/")>=0:return"/";case e.indexOf("\\")>=0:return"\\";default:return""}},y=e=>e.replace(/\s+/g," "),w="contract",v="transaction",P="script",T=e=>e.split(",").map(e=>e.replace(/\s*/g,"")).filter(e=>""!==e),A=(e,t)=>{const r=y(e.replace(/[\n\r]/g,""));if(r){const e=new RegExp(t,"g").exec(r);if(e)return""===e[1]?[]:T(e[1])}return[]},S=e=>A(e,"(?:prepare\\s*\\(\\s*)([^\\)]*)(?:\\))"),b=e=>A(e,"(?:fun\\s+main\\s*\\(\\s*)([^\\)]*)(?:\\))"),C=e=>A(e,"(?:transaction\\s*\\(\\s*)([^\\)]*)(?:\\))"),$=e=>{const t=e.replace(/(resource|struct)\s+\w+\s*{[\s\S]+?}/g,""),r=/\w+\s+contract\s+(?:interface)*\s*(\w*)(\s*{[.\s\S]*init\s*\((.*?)\)[.\s\S]*})?/g.exec(t);if(r.length<2)throw new Error("Contract Error: can't find name of the contract");return{contractName:r[1],args:r[3]||""}},k=e=>{if(/transaction\s*(\(\s*\))*\s*/g.test(e)){const t=S(e),r=C(e);return{type:v,signers:t.length,args:r}}if(/pub\s+fun\s+main\s*/g.test(e)){const t=b(e);return{type:P,args:t}}if(/\w+\s+contract\s+(\w*\s*)\w*/g.test(e)){const{contractName:t,args:r}=$(e);return{type:w,signers:1,args:r,contractName:t}}return{type:"unknown"}},j=e=>!e||"string"!=typeof e,E=e=>!j(e)&&(e.startsWith("Int")||e.startsWith("UInt")||e.startsWith("Word")),F=e=>{if(j(e))return!1;const t=e.replace(/\s/g,"");return t.startsWith("[")&&t.endsWith("]")},O=e=>{if(j(e))return!1;const t=e.replace(/\s/g,"");return t.startsWith("{")&&t.endsWith("}")},I=e=>F(e)||O(e),N=e=>e.split(/(\w+)\s*:\s*([\w{}[\]:\s?]*)/).filter(e=>""!==e).map(e=>e.replace(/\s*/g,"")),W=e=>N(e)[1],M=e=>/{(.*)}/.exec(e)[1].split(/([^:]*):(.*)/).map(e=>e.replace(/\s/g,"")).filter(e=>e),_=e=>/\[(.*)\]/.exec(e)[1].replace(/\s+/g,""),D=e=>!j(e)&&(e.includes("?")?s.Optional(s[(e=>e.slice(0,-1))(e)]):s[e]),L=e=>{if(I(e))switch(!0){case F(e):{const t=_(e);return s.Array(L(t))}case O(e):{const[t,r]=M(e);return s.Dictionary({key:L(t),value:L(r)})}default:return D(e)}return D(e)},R=(e,t)=>{const r=L(e);switch(!0){case(e=>{if(j(e))return!1;let t=e.endsWith("?")?e.slice(0,-1):e;return E(t)||(e=>"String"===e)(t)||(e=>"Character"===e)(t)||(e=>"Bool"===e)(t)})(e):return c.arg(t,r);case(e=>!j(e)&&(e.startsWith("Fix64")||e.startsWith("UFix64")))(e):return null===t?c.arg(null,r):(isNaN(parseFloat(t))&&(e=>{throw new Error("Type Error: Expected proper value for fixed type")})(),c.arg(parseFloat(t).toFixed(8),r));case(e=>"Address"===e||"Address?"===e)(e):{const e=null==(n=t)?null:"0x"+(e=>null==e?null:e.replace(/^0x/,""))(n);return c.arg(e,r)}case F(e):{const n=_(e);if(I(n)){const e=t.map(e=>R(n,e).value);return c.arg(e,r)}return c.arg(t,r)}case O(e):{const n=M(e)[1],o=[],s=Object.keys(t);for(let e=0;e<s.length;e++){const r=s[e];let c;c=I(n)?R(n,t[r]):t[r];const a=E(n)?parseInt(r):r;o.push({key:a,value:c})}return c.arg(o,r)}default:throw`${e} is not supported`}var n},q=(e=[],t)=>{if(t.length<e.length)throw new Error("Not enough arguments");return t.map((t,r)=>{const n=R(e[r],t);var o;return(o=n).xform.asArgument(o.value),n})},z=(e,t=[])=>{const r=k(e).args.map(W);return q(r,t)};function U(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}const B=function(e,t){try{const{code:r,cadence:n,args:o,addressMap:s,limit:a,processed:i}=e,u=r||n,l=i?u:m(u,s),p=a||100,f="script"===t?[c.script(l)]:[c.transaction(l)];if(o&&f.push(c.args(((e,t)=>{if(0===e.length)return[];const r=e[0];return Array.isArray(r)&&r[r.length-1].asArgument?(e=>e.reduce((e,t)=>[...e,...((e,t)=>{const r=e[e.length-1];return e.slice(0,-1).map(e=>((e,t)=>c.arg(e,t))(e,r))})(t)],[]))(e):z(t,e)})(o,r))),f.push(c.limit(p)),"transaction"===t){const{proposer:t,payer:r,signers:n=[]}=e,o=0===n.length?[r]:n,s=t||r;f.push(c.payer(r)),f.push(c.proposer(s)),f.push(c.authorizations(o))}return Promise.resolve(c.send(f))}catch(e){return Promise.reject(e)}},H=function(e){try{const{raw:t=!1}=e;return Promise.resolve(U(function(){return Promise.resolve(B(e,"script")).then(function(e){return t?[e.encodedData,null]:Promise.resolve(c.decode(e)).then(function(e){return[e,null]})})},function(e){return[null,e.message]}))}catch(e){return Promise.reject(e)}},V=function(e){try{const{wait:t="seal"}=e;return Promise.resolve(U(function(){return Promise.resolve(B(e,"transaction")).then(function(e){let r;function n(t){return r?t:[e.transactionId,null]}const o=function(){if(t){const n=(e=>{if("string"==typeof e){const t=e.toLowerCase();if(t.includes("final"))return"onceFinalized";if(t.includes("exec"))return"onceExecuted";if(t.includes("seal"))return"onceExecuted"}return console.log(`⚠️ [33mStatus value [1m[35m"${e}"[33m[2m is not supported. Reverting to [32m"onceSealed"[0m`),"onceSealed"})(t);return Promise.resolve(c.tx(e)[n]()).then(function(e){return r=1,[e,null]})}}();return o&&o.then?o.then(n):n(o)})},function(e){return[null,e.message]}))}catch(e){return Promise.reject(e)}},G=function(e){try{const{name:t,to:r,payer:n,proposer:o,code:s,update:c=!1,processed:a=!1,addressMap:i={}}=e,u=a?s:m(s,i),l=c?"\n    transaction(name: String, code: String) {\n      prepare(acct: AuthAccount){\n        let decoded = code.decodeHex()\n        \n        acct.contracts.add(\n          name: name,\n          code: decoded,\n        )\n      }\n    }\n  ":"\n  transaction(name: String, code: String){\n    prepare(acct: AuthAccount){\n      let decoded = code.decodeHex()\n      \n      if acct.contracts.get(name: name) == nil {\n        acct.contracts.add(name: name, code: decoded)\n      } else {\n        acct.contracts.update__experimental(name: name, code: decoded)\n      }\n    }\n  }\n",p=Buffer.from(u,"utf8").toString("hex");let f=r,d=r;return n&&(d=n,f=o||n),V({payer:d,proposer:f,signers:[r],code:l,args:[t,p]})}catch(e){return Promise.reject(e)}};e.CONTRACT=w,e.SCRIPT=P,e.TRANSACTION=v,e.argType=W,e.capitalizeFirstLetter=h,e.collapseSpaces=y,e.deployContract=G,e.executeScript=H,e.extract=A,e.extractContractName=e=>{const t=e.replace(/\r\n|\n|\r/g," "),r=/\w+\s+contract\s+(?:interface)*\s*(\w*)/g.exec(t);if(r.length<2)throw new Error("Contract Error: can't find name of the contract");return r[1]},e.extractContractParameters=$,e.extractImports=p,e.extractScriptArguments=b,e.extractSigners=S,e.extractTransactionArguments=C,e.generateSchema=T,e.getArrayType=_,e.getDictionaryTypes=M,e.getEnvironment=function(){try{return Promise.resolve(t.config().get("ix.env")).then(function(e){return a[e]||a.emulator})}catch(e){return Promise.reject(e)}},e.getSplitCharacter=x,e.getTemplateInfo=k,e.mapArgument=R,e.mapArguments=q,e.mapValuesToCode=z,e.missingImports=f,e.mutate=V,e.query=H,e.replaceImportAddresses=m,e.report=d,e.reportArguments=(e,t,r="")=>{if(t>e){const n=`Incorrect number of arguments: found ${e} of ${t}`;console.error(r?`${r} ${n}`:n)}},e.reportMissing=(e="items",t,r,n="")=>{if(r!==t){const o=`Incorrect number of ${e}: found ${t} of ${r}`;console.error(n?`${n} ${o}`:o)}},e.reportMissingImports=(e,t,r="")=>{const n=f(e,t);n.length>0&&d(n,r)},e.sendTransaction=V,e.setEnvironment=function(e="emulator",r={}){try{const n=e.toLowerCase();if(!a[n])throw new Error(`Provided value "${n}" is not supported. Try "emulator", "testnet" or "mainnet". Default: "emulator"`);const{port:o,endpoint:s}=r,c="emulator"===n&&o?`http://localhost:${o}`:i[n],u=s||c;return Promise.resolve(t.config().put("ix.env",n)).then(function(){return Promise.resolve(t.config().put("accessNode.api",u)).then(function(){})})}catch(e){return Promise.reject(e)}},e.splitArgs=N,e.trimAndSplit=(e,t,r)=>r?e.replace(t,"").split(r):e.replace(t,"").split(x(e)),e.underscoreToCamelCase=e=>e.replace(/-/g,"_").split("_").map((e,t)=>t>0?h(e):e).join(""),e.updateContract=function(e){try{return G({...e,update:!0})}catch(e){return Promise.reject(e)}}});
//# sourceMappingURL=index.umd.js.map
